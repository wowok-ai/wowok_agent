"use strict";(this.webpackChunkwowok_agent=this.webpackChunkwowok_agent||[]).push([[164],{8913:(t,s,e)=>{e.d(s,{LN:()=>_,OX:()=>i,aF:()=>r});var i,r,a=e(7745),n=e(9650),o=e(9880),h=e(572);!function(t){t[t.POLICY_MODE_FREE=0]="POLICY_MODE_FREE",t[t.POLICY_MODE_STRICT=1]="POLICY_MODE_STRICT"}(i||(i={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.WOWOK_GRANTEE=1]="WOWOK_GRANTEE",t[t.WOWOK_ORACLE=2]="WOWOK_ORACLE"}(r||(r={}));class _{get_object(){return this.object}constructor(t,s){this.txb=t,this.permission=s,this.object=""}static From(t,s,e){let i=new _(t,s);return i.object=a.Zs.TXB_OBJECT(t,e),i}static New(t,s,e,r=i.POLICY_MODE_FREE,n){a.Zs.IsValidObjects([s])||(0,h.f)(h.I.IsValidObjects,"permission"),(0,o.yW)(e)||(0,h.f)(h.I.IsValidDesription);let p=new _(t,s);return p.object=n?t.moveCall({target:a.Zs.Instance().repositoryFn("new_with_passport"),arguments:[n,t.pure.string(e),t.pure.u8(r),a.Zs.TXB_OBJECT(t,s)]}):t.moveCall({target:a.Zs.Instance().repositoryFn("new"),arguments:[t.pure.string(e),t.pure.u8(r),a.Zs.TXB_OBJECT(t,s)]}),p}launch(){return this.txb.moveCall({target:a.Zs.Instance().repositoryFn("create"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object)]})}add_data(t){_.IsValidName(t.key)||(0,h.f)(h.I.IsValidName,"add_data");let s=!0;t.data.forEach((t=>{(0,o.jE)(t.address)||(s=!1),_.IsValidValue(t.bcsBytes)||(s=!1)})),s||(0,h.f)(h.I.InvalidParam,"add_data"),void 0!==t?.value_type?t.data.forEach((s=>this.txb.moveCall({target:a.Zs.Instance().repositoryFn("add"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.address(s.address),this.txb.pure.string(t.key),this.txb.pure.u8(t.value_type),this.txb.pure.vector("u8",[...s.bcsBytes]),a.Zs.TXB_OBJECT(this.txb,this.permission)]}))):t.data.forEach((s=>this.txb.moveCall({target:a.Zs.Instance().repositoryFn("add_typed_data"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.address(s.address),this.txb.pure.string(t.key),this.txb.pure.vector("u8",[...s.bcsBytes]),a.Zs.TXB_OBJECT(this.txb,this.permission)]})))}add_data2(t){(0,o.jE)(t.address)||(0,h.f)(h.I.IsValidAddress,"add_data2");let s=!0;t.data.forEach((t=>{_.IsValidName(t.key)||(s=!1),_.IsValidValue(t.bcsBytes)||(s=!1)})),s||(0,h.f)(h.I.InvalidParam,"add_data2"),void 0!==t?.value_type?t.data.forEach((s=>this.txb.moveCall({target:a.Zs.Instance().repositoryFn("add"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.address(t.address),this.txb.pure.string(s.key),this.txb.pure.u8(t.value_type),this.txb.pure.vector("u8",[...s.bcsBytes]),a.Zs.TXB_OBJECT(this.txb,this.permission)]}))):t.data.forEach((s=>this.txb.moveCall({target:a.Zs.Instance().repositoryFn("add_typed_data"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.address(t.address),this.txb.pure.string(s.key),this.txb.pure.vector("u8",[...s.bcsBytes]),a.Zs.TXB_OBJECT(this.txb,this.permission)]})))}remove(t,s){_.IsValidName(s)||(0,h.f)(h.I.IsValidName),(0,o.jE)(t)||(0,h.f)(h.I.IsValidAddress),this.txb.moveCall({target:a.Zs.Instance().repositoryFn("remove"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.address(t),this.txb.pure.string(s),a.Zs.TXB_OBJECT(this.txb,this.permission)]})}add_reference(t,s){0!==t.length&&((0,o.ij)(t,o.jE)||(0,h.f)(h.I.IsValidArray,"add_reference"),s?this.txb.moveCall({target:a.Zs.Instance().repositoryFn("reference_add_with_passport"),arguments:[s,a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.vector("address",(0,o.SI)(t)),a.Zs.TXB_OBJECT(this.txb,this.permission)]}):this.txb.moveCall({target:a.Zs.Instance().repositoryFn("reference_add"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.vector("address",(0,o.SI)(t)),a.Zs.TXB_OBJECT(this.txb,this.permission)]}))}remove_reference(t,s,e){(0!==t.length||s)&&((0,o.ij)(t,o.jE)||(0,h.f)(h.I.IsValidArray,"remove_reference"),s?e?this.txb.moveCall({target:a.Zs.Instance().repositoryFn("reference_removeall_with_passport"),arguments:[e,a.Zs.TXB_OBJECT(this.txb,this.object),a.Zs.TXB_OBJECT(this.txb,this.permission)]}):this.txb.moveCall({target:a.Zs.Instance().repositoryFn("reference_removeall"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),a.Zs.TXB_OBJECT(this.txb,this.permission)]}):e?this.txb.moveCall({target:a.Zs.Instance().repositoryFn("reference_remove_with_passport"),arguments:[e,a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.vector("address",(0,o.SI)(t)),a.Zs.TXB_OBJECT(this.txb,this.permission)]}):this.txb.moveCall({target:a.Zs.Instance().repositoryFn("reference_remove"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.vector("address",(0,o.SI)(t)),a.Zs.TXB_OBJECT(this.txb,this.permission)]}))}add_policies(t,s){if(0===t.length)return;let e=!0;t.forEach((t=>{(0,o.yW)(t.description)&&_.IsValidName(t.key)||(e=!1)})),e||(0,h.f)(h.I.InvalidParam,"policies"),t.forEach((t=>{let e=this.txb.pure.option("u64",t?.permissionIndex?t?.permissionIndex:void 0);s?this.txb.moveCall({target:a.Zs.Instance().repositoryFn("policy_add_with_passport"),arguments:[s,a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.string(t.key),this.txb.pure.string(t.description),e,this.txb.pure.u8(t.dataType),a.Zs.TXB_OBJECT(this.txb,this.permission)]}):this.txb.moveCall({target:a.Zs.Instance().repositoryFn("policy_add"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.string(t.key),this.txb.pure.string(t.description),e,this.txb.pure.u8(t.dataType),a.Zs.TXB_OBJECT(this.txb,this.permission)]})}))}remove_policies(t,s,e){0!==t.length&&((0,o.ij)(t,_.IsValidName)||(0,h.f)(h.I.InvalidParam,"policy_keys"),e?s?this.txb.moveCall({target:a.Zs.Instance().repositoryFn("policy_removeall_with_passport"),arguments:[e,a.Zs.TXB_OBJECT(this.txb,this.object),a.Zs.TXB_OBJECT(this.txb,this.permission)]}):this.txb.moveCall({target:a.Zs.Instance().repositoryFn("policy_remove_with_passport"),arguments:[e,a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.vector("string",(0,o.SI)(t)),a.Zs.TXB_OBJECT(this.txb,this.permission)]}):s?this.txb.moveCall({target:a.Zs.Instance().repositoryFn("policy_removeall"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),a.Zs.TXB_OBJECT(this.txb,this.permission)]}):this.txb.moveCall({target:a.Zs.Instance().repositoryFn("policy_remove"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.vector("string",(0,o.SI)(t)),a.Zs.TXB_OBJECT(this.txb,this.permission)]}))}rename_policy(t,s,e){(0,o.S7)(t)&&(0,o.S7)(s)||(0,h.f)(h.I.IsValidName,"change_policy"),e?this.txb.moveCall({target:a.Zs.Instance().repositoryFn("policy_rename_with_passport"),arguments:[e,a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.string(t),this.txb.pure.string(s),a.Zs.TXB_OBJECT(this.txb,this.permission)]}):this.txb.moveCall({target:a.Zs.Instance().repositoryFn("policy_rename"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.string(t),this.txb.pure.string(s),a.Zs.TXB_OBJECT(this.txb,this.permission)]})}set_description(t,s){(0,o.yW)(t)||(0,h.f)(h.I.IsValidDesription),s?this.txb.moveCall({target:a.Zs.Instance().repositoryFn("description_set_with_passport"),arguments:[s,a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.string(t),a.Zs.TXB_OBJECT(this.txb,this.permission)]}):this.txb.moveCall({target:a.Zs.Instance().repositoryFn("description_set"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.string(t),a.Zs.TXB_OBJECT(this.txb,this.permission)]})}set_policy_mode(t,s){s?this.txb.moveCall({target:a.Zs.Instance().repositoryFn("mode_set_with_passport"),arguments:[s,a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.u8(t),a.Zs.TXB_OBJECT(this.txb,this.permission)]}):this.txb.moveCall({target:a.Zs.Instance().repositoryFn("mode_set"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.u8(t),a.Zs.TXB_OBJECT(this.txb,this.permission)]})}set_policy_description(t,s,e){_.IsValidName(t)||(0,h.f)(h.I.IsValidName,"policy"),(0,o.yW)(s)||(0,h.f)(h.I.IsValidDesription),e?this.txb.moveCall({target:a.Zs.Instance().repositoryFn("policy_description_set_with_passport"),arguments:[e,a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.string(t),this.txb.pure.string(s),a.Zs.TXB_OBJECT(this.txb,this.permission)]}):this.txb.moveCall({target:a.Zs.Instance().repositoryFn("policy_description_set"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.string(t),this.txb.pure.string(s),a.Zs.TXB_OBJECT(this.txb,this.permission)]})}set_policy_permission(t,s,e){_.IsValidName(t)||(0,h.f)(h.I.IsValidName,"policy");let i=this.txb.pure.option("u64",void 0);void 0!==s&&(n.aX.IsValidPermissionIndex(s)||(0,h.f)(h.I.IsValidPermissionIndex),i=this.txb.pure.option("u64",s)),e?this.txb.moveCall({target:a.Zs.Instance().repositoryFn("policy_permission_set_with_passport"),arguments:[e,a.Zs.TXB_OBJECT(this.txb,this.object),i,a.Zs.TXB_OBJECT(this.txb,this.permission)]}):this.txb.moveCall({target:a.Zs.Instance().repositoryFn("policy_permission_set"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),i,a.Zs.TXB_OBJECT(this.txb,this.permission)]})}change_permission(t){a.Zs.IsValidObjects([t])||(0,h.f)(h.I.IsValidObjects),this.txb.moveCall({target:a.Zs.Instance().repositoryFn("permission_set"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),a.Zs.TXB_OBJECT(this.txb,this.permission),a.Zs.TXB_OBJECT(this.txb,t)],typeArguments:[]}),this.permission=t}static rpc_de_data(t){const s=t?.map((t=>{const s=new Uint8Array(t?.data?.content?.fields?.value),e=s?.length>0?s[0]:null;var i=s.length>0?s.slice(1):Uint8Array.from([]);return e===a.eV.TYPE_STRING?(i=o.ji.getInstance().de(a.eV.TYPE_VEC_U8,i),i=(new TextDecoder).decode(Uint8Array.from(i))):e===a.eV.TYPE_VEC_STRING?i=(i=o.ji.getInstance().de(a.eV.TYPE_VEC_VEC_U8,i)).map((t=>(new TextDecoder).decode(Uint8Array.from(t)))):(i=o.ji.getInstance().de(s[0],i),e===a.eV.TYPE_ADDRESS?i="0x"+i:e===a.eV.TYPE_VEC_ADDRESS?i=i.map((t=>"0x"+t)):e===a.eV.TYPE_BOOL&&(i=i?"True":"False")),{object:t?.data?.content?.fields?.id?.id,id:t?.data?.content?.fields?.name?.fields?.id,name:t?.data?.content?.fields?.name?.fields?.key,data:i,dataType:(0,o.XF)(e)}}));return s}static DataType2ValueType(t){try{const s=BigInt(t);if(a.eV.TYPE_U8,s<=o.b_);else if(s<=o.VP)a.eV.TYPE_U64;else if(s<=o.Mc)a.eV.TYPE_U128;else{if(!(s<=o._J))return;a.eV.TYPE_U256}}catch(t){console.log(t)}}}_.MAX_POLICY_COUNT=120,_.MAX_KEY_LENGTH=128,_.MAX_VALUE_LENGTH=204800,_.MAX_REFERENCE_COUNT=100,_.IsValidName=t=>t.length<=_.MAX_KEY_LENGTH&&0!=t.length,_.IsValidValue=t=>t.length<_.MAX_VALUE_LENGTH,_.ResolveRepositoryData=(t,s)=>{if(t===a.ml.String)return{type:a.eV.TYPE_STRING,data:o.ji.getInstance().ser(a.eV.TYPE_VEC_U8,(new TextEncoder).encode(s.toString()))};if(t===a.ml.PositiveNumber){const t=_.DataType2ValueType(s);if(!t)return;return{type:t,data:o.ji.getInstance().ser(t,s)}}if(t===a.ml.Address){if(!(0,o.jE)(s))return;return{type:a.eV.TYPE_ADDRESS,data:o.ji.getInstance().ser(a.eV.TYPE_ADDRESS,s)}}if(t===a.ml.Address_Vec){for(let t=0;t<s.length;++t)if(!(0,o.jE)(s[t]))return;return{type:a.eV.TYPE_VEC_ADDRESS,data:o.ji.getInstance().ser(a.eV.TYPE_VEC_ADDRESS,s)}}if(t===a.ml.PositiveNumber_Vec){let t=a.eV.TYPE_U8;for(let e=0;e<s.length;++e){const e=_.DataType2ValueType(s);if(!e)return;e>t&&(t=e)}return t=t===a.eV.TYPE_U8?a.eV.TYPE_VEC_U8:t===a.eV.TYPE_U64?a.eV.TYPE_VEC_U64:t===a.eV.TYPE_U128?a.eV.TYPE_VEC_U128:a.eV.TYPE_VEC_U256,{type:t,data:o.ji.getInstance().ser(t,s)}}if(t===a.ml.String_Vec){const t=s.map((t=>(new TextEncoder).encode(t)));return{type:a.eV.TYPE_VEC_STRING,data:o.ji.getInstance().ser(a.eV.TYPE_VEC_VEC_U8,t)}}if(t===a.ml.Bool){if("boolean"!=typeof s)return;return{type:a.eV.TYPE_BOOL,data:o.ji.getInstance().ser(a.eV.TYPE_BOOL,s)}}}}}]);