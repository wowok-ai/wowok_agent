"use strict";(this.webpackChunkwowok_agent=this.webpackChunkwowok_agent||[]).push([[495],{4285:(e,t,s)=>{s.d(t,{u:()=>o});var a=s(9554),r=s(1609),i=s(5873),n=s(5337);class o{txb;object;permission;get_object(){return this.object}static From(e,t,s){let r=new o(e,t);return r.object=a.Zs.TXB_OBJECT(e,s),r}constructor(e,t){this.txb=e,this.permission=t,this.object=""}static New(e,t,s,i,c){a.Zs.IsValidObjects([t])||(0,n.f)(n.I.IsValidObjects,"permission"),(0,r.yW)(s)||(0,n.f)(n.I.IsValidDesription),i&&!(0,r.Eh)(i)&&(0,n.f)(n.I.IsValidEndpoint);let _=new o(e,t),l=e.pure.option("string",i||void 0);return _.object=c?e.moveCall({target:a.Zs.Instance().machineFn("new_with_passport"),arguments:[c,e.pure.string(s),l,a.Zs.TXB_OBJECT(e,t)]}):e.moveCall({target:a.Zs.Instance().machineFn("new"),arguments:[e.pure.string(s),l,a.Zs.TXB_OBJECT(e,t)]}),_}add_node(e,t){if(0===e.length)return;let s=!0;e.forEach((e=>{(0,r.S7)(e.name)||(s=!1),e.pairs.forEach((e=>{(0,r.Xx)(e.prior_node)||(s=!1),e?.threshold&&!(0,r.aH)(e.threshold)&&(s=!1),e.forwards.forEach((e=>{""!==o.checkValidForward(e)&&(s=!1)}))}))})),s||(0,n.f)(n.I.InvalidParam,"add_node");let i=[];e.forEach((e=>{let t=this.txb.moveCall({target:a.Zs.Instance().machineFn("node_new"),arguments:[this.txb.pure.string(e.name)]});e.pairs.forEach((e=>{let s=this.txb.pure.option("u32",e?.threshold);e.forwards.forEach((r=>{this.txb.moveCall({target:a.Zs.Instance().machineFn("forward_add"),arguments:[t,this.txb.pure.string(e.prior_node),this.txb.pure.string(r.name),s,this.forward(r)]})})),0===e.forwards.length&&this.txb.moveCall({target:a.Zs.Instance().machineFn("forward_add_none"),arguments:[t,this.txb.pure.string(e.prior_node),s]})})),i.push(t)})),this.add_node2(i,t)}forward(e){let t,s=e?.weight?e.weight:1;return e?.namedOperator&&(0,r.S7)(e.namedOperator)?t=e?.guard?this.txb.moveCall({target:a.Zs.Instance().machineFn("forward"),arguments:[this.txb.pure.string(e.namedOperator),this.txb.pure.u16(s),this.txb.object(a.Zs.TXB_OBJECT(this.txb,e.guard))]}):this.txb.moveCall({target:a.Zs.Instance().machineFn("forward2"),arguments:[this.txb.pure.string(e.namedOperator),this.txb.pure.u16(s)]}):void 0!==e?.permission&&(0,r.Ec)(e.permission)?t=e?.guard?this.txb.moveCall({target:a.Zs.Instance().machineFn("forward3"),arguments:[this.txb.pure.u64(e.permission),this.txb.pure.u16(s),this.txb.object(a.Zs.TXB_OBJECT(this.txb,e.guard))]}):this.txb.moveCall({target:a.Zs.Instance().machineFn("forward4"),arguments:[this.txb.pure.u64(e.permission),this.txb.pure.u16(s)]}):(0,n.f)(n.I.InvalidParam,"forward"),e?.suppliers?.forEach((e=>{(0,r.MA)(e.pay_token_type)||(0,n.f)(n.I.IsValidTokenType,"forward.suppliers:"+e.object),this.txb.moveCall({target:a.Zs.Instance().serviceFn("add_to"),arguments:[this.txb.object(e.object),this.txb.pure.bool(e.bRequired??!1),t],typeArguments:[e.pay_token_type]})})),t}add_node2(e,t){if(0===e.length)return;let s=e.map((e=>a.Zs.TXB_OBJECT(this.txb,e)));t?this.txb.moveCall({target:a.Zs.Instance().machineFn("node_add_with_passport"),arguments:[t,a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.makeMoveVec({elements:s}),a.Zs.TXB_OBJECT(this.txb,this.permission)]}):this.txb.moveCall({target:a.Zs.Instance().machineFn("node_add"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.makeMoveVec({elements:s}),a.Zs.TXB_OBJECT(this.txb,this.permission)]})}fetch_node(e,t){return(0,r.S7)(e)||(0,n.f)(n.I.IsValidName,"fetch_node"),t?this.txb.moveCall({target:a.Zs.Instance().machineFn("node_fetch_with_passport"),arguments:[t,a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.string(e),a.Zs.TXB_OBJECT(this.txb,this.permission)]}):this.txb.moveCall({target:a.Zs.Instance().machineFn("node_fetch"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.string(e),a.Zs.TXB_OBJECT(this.txb,this.permission)]})}rename_node(e,t,s){e!==t&&((0,r.S7)(e)||(0,n.f)(n.I.IsValidName,"rename_node"),(0,r.S7)(t)||(0,n.f)(n.I.IsValidName,"rename_node"),s?this.txb.moveCall({target:a.Zs.Instance().machineFn("node_rename_with_passport"),arguments:[s,a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.string(e),this.txb.pure.string(t),a.Zs.TXB_OBJECT(this.txb,this.permission)]}):this.txb.moveCall({target:a.Zs.Instance().machineFn("node_rename"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.string(e),this.txb.pure.string(t),a.Zs.TXB_OBJECT(this.txb,this.permission)]}))}remove_node(e,t=!1,s){0!==e.length&&((0,r.ij)(e,r.S7)||(0,n.f)(n.I.IsValidArray,"nodes_name"),s?this.txb.moveCall({target:a.Zs.Instance().machineFn("node_remove_with_passport"),arguments:[s,a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.vector("string",e),this.txb.pure.bool(t),a.Zs.TXB_OBJECT(this.txb,this.permission)]}):this.txb.moveCall({target:a.Zs.Instance().machineFn("node_remove"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.vector("string",e),this.txb.pure.bool(t),a.Zs.TXB_OBJECT(this.txb,this.permission)]}))}launch(){return this.txb.moveCall({target:a.Zs.Instance().machineFn("create"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object)]})}set_description(e,t){(0,r.yW)(e)||(0,n.f)(n.I.IsValidDesription),t?this.txb.moveCall({target:a.Zs.Instance().machineFn("description_set_with_passport"),arguments:[t,a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.string(e),a.Zs.TXB_OBJECT(this.txb,this.permission)]}):this.txb.moveCall({target:a.Zs.Instance().machineFn("description_set"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.string(e),a.Zs.TXB_OBJECT(this.txb,this.permission)]})}add_repository(e,t){t?this.txb.moveCall({target:a.Zs.Instance().machineFn("repository_add_with_passport"),arguments:[t,a.Zs.TXB_OBJECT(this.txb,this.object),a.Zs.TXB_OBJECT(this.txb,e),a.Zs.TXB_OBJECT(this.txb,this.permission)]}):this.txb.moveCall({target:a.Zs.Instance().machineFn("repository_add"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),a.Zs.TXB_OBJECT(this.txb,e),a.Zs.TXB_OBJECT(this.txb,this.permission)]})}remove_repository(e,t,s){(t||0!==e.length)&&((0,r.ij)(e,r.jE)||(0,n.f)(n.I.IsValidArray,"remove_repository"),s?t?this.txb.moveCall({target:a.Zs.Instance().machineFn("repository_remove_all_with_passport"),arguments:[s,a.Zs.TXB_OBJECT(this.txb,this.object),a.Zs.TXB_OBJECT(this.txb,this.object)]}):this.txb.moveCall({target:a.Zs.Instance().machineFn("repository_remove_with_passport"),arguments:[s,a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.vector("address",(0,r.SI)(e)),a.Zs.TXB_OBJECT(this.txb,this.permission)]}):t?this.txb.moveCall({target:a.Zs.Instance().machineFn("repository_remove_all"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),a.Zs.TXB_OBJECT(this.txb,this.permission)]}):this.txb.moveCall({target:a.Zs.Instance().machineFn("repository_remove"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.vector("address",(0,r.SI)(e)),a.Zs.TXB_OBJECT(this.txb,this.permission)]}))}clone(e,t){let s;return s=t?this.txb.moveCall({target:a.Zs.Instance().machineFn("clone_with_passport"),arguments:[t,a.Zs.TXB_OBJECT(this.txb,this.object),a.Zs.TXB_OBJECT(this.txb,this.permission)]}):this.txb.moveCall({target:a.Zs.Instance().machineFn("clone"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),a.Zs.TXB_OBJECT(this.txb,this.permission)]}),e?this.txb.moveCall({target:a.Zs.Instance().machineFn("create"),arguments:[a.Zs.TXB_OBJECT(this.txb,s)]}):s}set_endpoint(e,t){e&&!(0,r.Eh)(e)&&(0,n.f)(n.I.IsValidEndpoint);let s=this.txb.pure.option("string",e||void 0);t?this.txb.moveCall({target:a.Zs.Instance().machineFn("endpoint_set_with_passport"),arguments:[t,a.Zs.TXB_OBJECT(this.txb,this.object),s,a.Zs.TXB_OBJECT(this.txb,this.permission)]}):this.txb.moveCall({target:a.Zs.Instance().machineFn("endpoint_set"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),s,a.Zs.TXB_OBJECT(this.txb,this.permission)]})}pause(e,t){t?this.txb.moveCall({target:a.Zs.Instance().machineFn("pause_with_passport"),arguments:[t,a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.bool(e),a.Zs.TXB_OBJECT(this.txb,this.permission)]}):this.txb.moveCall({target:a.Zs.Instance().machineFn("pause"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.bool(e),a.Zs.TXB_OBJECT(this.txb,this.permission)]})}publish(e){e?this.txb.moveCall({target:a.Zs.Instance().machineFn("publish_with_passport"),arguments:[e,a.Zs.TXB_OBJECT(this.txb,this.object),a.Zs.TXB_OBJECT(this.txb,this.permission)]}):this.txb.moveCall({target:a.Zs.Instance().machineFn("publish"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),a.Zs.TXB_OBJECT(this.txb,this.permission)]})}change_permission(e){a.Zs.IsValidObjects([e])||(0,n.f)(n.I.IsValidObjects,"new_permission"),this.txb.moveCall({target:a.Zs.Instance().machineFn("permission_set"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),a.Zs.TXB_OBJECT(this.txb,this.permission),a.Zs.TXB_OBJECT(this.txb,e)],typeArguments:[]}),this.permission=e}add_forward(e,t,s,i,c,_){(0,r.Xx)(e)||(0,n.f)(n.I.IsValidName_AllowEmpty,"add_forward"),(0,r.S7)(t)||(0,n.f)(n.I.IsValidName,"add_forward");const l=o.checkValidForward(s);let h;l&&(0,n.f)(n.I.InvalidParam,l),h=_?this.txb.moveCall({target:a.Zs.Instance().machineFn("node_fetch_with_passport"),arguments:[_,a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.string(t),a.Zs.TXB_OBJECT(this.txb,this.permission)]}):this.txb.moveCall({target:a.Zs.Instance().machineFn("node_fetch"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.string(t),a.Zs.TXB_OBJECT(this.txb,this.permission)]});const p=this.forward(s),d=this.txb.pure.option("u32",i??void 0);this.txb.moveCall({target:a.Zs.Instance().machineFn("forward_add"),arguments:[h,this.txb.pure.string(e),this.txb.pure.string(s.name),d,p]}),c&&c!==s.name&&this.txb.moveCall({target:a.Zs.Instance().machineFn("forward_remove"),arguments:[h,this.txb.pure.string(e),this.txb.pure.string(c)]}),this.add_node2([h],_)}remove_pair(e,t,s){let i;(0,r.Xx)(e)||(0,n.f)(n.I.IsValidName_AllowEmpty,"remove_pair"),(0,r.S7)(t)||(0,n.f)(n.I.IsValidName,"remove_pair"),i=s?this.txb.moveCall({target:a.Zs.Instance().machineFn("node_fetch_with_passport"),arguments:[s,a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.string(t),a.Zs.TXB_OBJECT(this.txb,this.permission)]}):this.txb.moveCall({target:a.Zs.Instance().machineFn("node_fetch"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.string(t),a.Zs.TXB_OBJECT(this.txb,this.permission)]}),this.txb.moveCall({target:a.Zs.Instance().machineFn("pair_remove"),arguments:[i,this.txb.pure.string(e)]}),this.add_node2([i],s)}remove_forward(e,t,s,i){let o;(0,r.Xx)(e)||(0,n.f)(n.I.IsValidName_AllowEmpty,"remove_forward"),(0,r.S7)(t)||(0,n.f)(n.I.IsValidName,"remove_forward"),o=i?this.txb.moveCall({target:a.Zs.Instance().machineFn("node_fetch_with_passport"),arguments:[i,a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.string(t),a.Zs.TXB_OBJECT(this.txb,this.permission)]}):this.txb.moveCall({target:a.Zs.Instance().machineFn("node_fetch"),arguments:[a.Zs.TXB_OBJECT(this.txb,this.object),this.txb.pure.string(t),a.Zs.TXB_OBJECT(this.txb,this.permission)]}),this.txb.moveCall({target:a.Zs.Instance().machineFn("forward_remove"),arguments:[o,this.txb.pure.string(e),this.txb.pure.string(s)]}),this.add_node2([o],i)}static rpc_de_nodes(e){const t=[];return e.forEach((e=>{t.push({name:e.data.content.fields.name,pairs:o.rpc_de_pair(e?.data.content.fields.value)})})),t}static rpc_de_pair(e){let t=[];return e.fields.value.fields.contents.forEach((e=>{let s=[];e.fields.value.fields.forwards.fields.contents.forEach((e=>{let t=e.fields.key,a=e.fields.value.fields.weight,r=e.fields.value.fields.guard,i=e.fields.value.fields.namedOperator,n=e.fields.value.fields.permission_index;s.push({name:t,namedOperator:i,permission:n,weight:a,guard:r||"",suppliers:e.fields.value.fields.suppliers.fields.contents.map((e=>({object:e.fields.key,bRequired:e.fields.value,pay_token_type:""})))})})),t.push({prior_node:e.fields.key,threshold:e.fields.value.fields.threshold,forwards:s})})),t}static namedOperators(e){let t=[];return e.forEach((e=>{e.pairs.forEach((e=>{e.forwards.forEach((e=>{e?.namedOperator&&!t.find((t=>t===e.namedOperator))&&t.push(e.namedOperator)}))}))})),t}static checkValidForward(e){return(0,r.S7)(e.name)?e?.namedOperator&&!(0,r.Xx)(e?.namedOperator)?"Progress Operator invalid":e?.permission&&!i.aX.IsValidPermissionIndex(e?.permission)?"Permission index invalid":e?.permission||e?.namedOperator?e?.weight&&!(0,r.Ec)(e.weight)?"Weight invalid":"":"Business-Permissions invalid":"Forward name invalid"}static INITIAL_NODE_NAME="";static OPERATOR_ORDER_PAYER="OrderPayer"}},7495:(e,t,s)=>{s.r(t),s.d(t,{Arbitration:()=>O.w,BCS:()=>v.r8,Bcs:()=>i.ji,BuyRequiredEnum:()=>E.bU,ContextType:()=>_.EL,Demand:()=>a.Y,ENTRYPOINT:()=>_.$Q,ERROR:()=>h.f,Ed25519Keypair:()=>P.h,Entity:()=>T.w,Errors:()=>h.I,FirstLetterUppercase:()=>i.Li,FunctionGroup:()=>o.g$,GUARD_QUERIES:()=>o.J2,Guard:()=>o.wM,GuardFunctions:()=>o.hJ,GuardMaker:()=>o.uR,GuardParser:()=>p,IsNumberType:()=>_.KE,IsValidAddress:()=>i.jE,IsValidArgType:()=>i.Tg,IsValidArray:()=>i.ij,IsValidBigint:()=>i.CT,IsValidCoinType:()=>i.UR,IsValidDesription:()=>i.yW,IsValidEndpoint:()=>i.Eh,IsValidGuardIdentifier:()=>o.te,IsValidInt:()=>i.aH,IsValidName:()=>i.S7,IsValidName_AllowEmpty:()=>i.Xx,IsValidOperatorType:()=>_.p_,IsValidPercent:()=>i.qF,IsValidTokenType:()=>i.MA,IsValidU128:()=>i.ds,IsValidU256:()=>i.R0,IsValidU64:()=>i.Ec,IsValidU8:()=>i.U5,IsValidValueType:()=>_.E6,LogicsInfo:()=>_.Kf,MAX_DESCRIPTION_LENGTH:()=>i.Lj,MAX_ENDPOINT_LENGTH:()=>i.Mb,MAX_NAME_LENGTH:()=>i.EM,MAX_U128:()=>i.Mc,MAX_U256:()=>i._J,MAX_U64:()=>i.VP,MAX_U8:()=>i.b_,MODULES:()=>_.e$,Machine:()=>u.u,OPTION_NONE:()=>i.xT,OperatorType:()=>_.hu,OperatorTypeArray:()=>_.A0,PAYMENT_MAX_RECEIVER_COUNT:()=>f,ParseType:()=>i.O_,Passport:()=>d,Permission:()=>n.aX,PermissionIndex:()=>n.w6,PermissionInfo:()=>n._$,Progress:()=>r.k,Protocol:()=>_.Zs,Repository:()=>c.LN,RepositoryValueType:()=>_.ml,RepositoryValueTypeInfo:()=>_.o8,Repository_Policy_Mode:()=>c.OX,Repository_Type:()=>c.aF,ResolveBalance:()=>i.xI,ResolveU64:()=>i.oV,Resource:()=>b.F,RpcResultParser:()=>_.GX,SER_VALUE:()=>_.Bd,Service:()=>E.kl,Service_Discount_Type:()=>E.P_,SuiClient:()=>C.x,TagName:()=>b.K,TransactionBlock:()=>y.Z,Treasury:()=>I.mE,Treasury_Operation:()=>I._5,Treasury_WithdrawMode:()=>I.uE,ValueType:()=>_.eV,ValueTypeArray:()=>_.pl,ValueTypeConvert:()=>i.XF,Wowok:()=>m.S,array_equal:()=>i.p_,array_unique:()=>i.SI,capitalize:()=>i.ZH,cb_U128:()=>i.x_,cb_U256:()=>i.pq,cb_U64:()=>i.Ys,cb_U8:()=>i.gV,concatenate:()=>i.u1,create_payment:()=>g,decodeSuiPrivateKey:()=>B.At,deepClone:()=>i.Go,encodeSuiPrivateKey:()=>B.yk,fromHEX:()=>x.i,getFaucetHost:()=>V.lG,getSuiMoveConfig:()=>v.PN,getUTCDayStartByDivision:()=>i.DQ,hasDuplicates:()=>i.bT,insertAtHead:()=>i.$Q,isArr:()=>i.Ep,isValidHttpUrl:()=>i.U8,normalizeSuiAddress:()=>U.t4,numToUint8Array:()=>i.$q,parseObjectType:()=>i.q5,parse_object_type:()=>i.Lw,query_object:()=>i.tH,readOption:()=>i.gz,readOptionString:()=>i.Hn,readVec:()=>i.IN,requestSuiFromFaucetV0:()=>V.RJ,requestSuiFromFaucetV1:()=>V.Yl,stringToUint8Array:()=>i.Al,toFixed:()=>i.Mg,toHEX:()=>x.J,ulebDecode:()=>i.jz});var a=s(8021),r=s(4289),i=s(1609),n=s(5873),o=s(701),c=s(1210),_=s(9554),l=s(2748),h=s(5337);class p{guard_list=[];guards;constructor(e){this.guards=e}guardlist=()=>this.guard_list;static DeGuardObject_FromData=(e,t)=>{let s=p.parse_constant(e),a=p.parse_bcs(s,t);a&&0!=a.length||(0,h.f)(h.I.Fail,"GuardObject: data parsed error");let r=[];return a.forEach((e=>{p.ResolveData(s,r,{...e,child:[]})})),1!=r.length&&(0,h.f)(h.I.Fail,"GuardObject: parse error"),{object:r.pop(),constant:s}};static DeGuardObject=async(e,t)=>{(0,i.jE)(t)||(0,h.f)(h.I.IsValidAddress,"GuardObject guard");let s=await e.query_raw([t]);0!=s.length&&s[0].data&&s[0].data?.objectId==t||(0,h.f)(h.I.Fail,"GuardObject query error");let a=s[0].data.content;return a?.type!=e.package("base")+"::guard::Guard"&&(0,h.f)(h.I.Fail,"GuardObject object invalid"),p.DeGuardObject_FromData(a.fields.constants,a.fields.input.fields.bytes)};static ResolveData=(e,t,s)=>{switch(s.type){case _.hu.TYPE_LOGIC_NOT:return s.ret_type=_.eV.TYPE_BOOL,t.length<1&&(0,h.f)(h.I.Fail,"ResolveData: TYPE_LOGIC_NOT"),(a=t.pop()).ret_type&&a.ret_type==_.eV.TYPE_BOOL||(0,h.f)(h.I.Fail,"ResolveData: TYPE_LOGIC_NOT type invalid"),s.child.push(a),void t.push(s);case _.hu.TYPE_NUMBER_ADDRESS:var a;return s.ret_type=_.eV.TYPE_ADDRESS,t.length<1&&(0,h.f)(h.I.Fail,"ResolveData: TYPE_NUMBER_ADDRESS"),(a=t.pop()).ret_type&&o.uR.match_u256(a.ret_type)||(0,h.f)(h.I.Fail,"ResolveData: TYPE_NUMBER_ADDRESS type invalid"),s.child.push(a),void t.push(s);case _.hu.TYPE_LOGIC_AS_U256_GREATER:case _.hu.TYPE_LOGIC_AS_U256_GREATER_EQUAL:case _.hu.TYPE_LOGIC_AS_U256_LESSER:case _.hu.TYPE_LOGIC_AS_U256_LESSER_EQUAL:case _.hu.TYPE_LOGIC_AS_U256_EQUAL:case _.hu.TYPE_NUMBER_ADD:case _.hu.TYPE_NUMBER_DEVIDE:case _.hu.TYPE_NUMBER_MOD:case _.hu.TYPE_NUMBER_MULTIPLY:case _.hu.TYPE_NUMBER_SUBTRACT:s.type===_.hu.TYPE_LOGIC_AS_U256_GREATER||s.type===_.hu.TYPE_LOGIC_AS_U256_GREATER_EQUAL||s.type===_.hu.TYPE_LOGIC_AS_U256_LESSER||s.type===_.hu.TYPE_LOGIC_AS_U256_LESSER_EQUAL||s.type===_.hu.TYPE_LOGIC_AS_U256_EQUAL?s.ret_type=_.eV.TYPE_BOOL:s.ret_type=_.eV.TYPE_U256,(t.length<s.value||s.value<2)&&(0,h.f)(h.I.Fail,"ResolveData: "+s.type);for(let e=0;e<s.value;++e)(i=t.pop()).ret_type&&o.uR.match_u256(i.ret_type)||(0,h.f)(h.I.Fail,"ResolveData: "+s.type+" INVALID param type"),s.child.push(i);return void t.push(s);case _.hu.TYPE_LOGIC_EQUAL:s.ret_type=_.eV.TYPE_BOOL,(t.length<s.value||s.value<2)&&(0,h.f)(h.I.Fail,"ResolveData: "+s.type);var r=t.pop();s.child.push(r);for(let e=1;e<s.value;++e)(i=t.pop()).ret_type&&i.ret_type==r.ret_type||(0,h.f)(h.I.Fail,"ResolveData: "+s.type+" INVALID param type"),s.child.push(i);return void t.push(s);case _.hu.TYPE_LOGIC_HAS_SUBSTRING:s.ret_type=_.eV.TYPE_BOOL,(t.length<s.value||s.value<2)&&(0,h.f)(h.I.Fail,"ResolveData: "+s.type);for(let e=0;e<s.value;++e)(i=t.pop()).ret_type&&i.ret_type==_.eV.TYPE_STRING||(0,h.f)(h.I.Fail,"ResolveData: "+s.type+" INVALID param type"),s.child.push(i);return void t.push(s);case _.hu.TYPE_LOGIC_AND:case _.hu.TYPE_LOGIC_OR:s.ret_type=_.eV.TYPE_BOOL,(t.length<s.value||s.value<2)&&(0,h.f)(h.I.Fail,"ResolveData: "+s.type);for(let e=0;e<s.value;++e){var i;(i=t.pop()).ret_type&&i.ret_type==_.eV.TYPE_BOOL||(0,h.f)(h.I.Fail,"ResolveData: "+s.type+" INVALID param type"),s.child.push(i)}return void t.push(s);case _.hu.TYPE_QUERY:s?.cmd||(0,h.f)(h.I.Fail,"OperateParamCount: cmd invalid "+s.type);let n=o.wM.GetCmd(s.cmd);return n||(0,h.f)(h.I.Fail,"OperateParamCount: cmd not supported "+s.type),s.ret_type=n?.return,t.length<n.parameters.length&&(0,h.f)(h.I.Fail,"OperateParamCount: cmd param lost "+s.type),n.parameters.forEach((e=>{let a=t.pop();a?.ret_type&&a.ret_type==e||(0,h.f)(h.I.Fail,"OperateParamCount: cmd param not match "+s.type),s.child.push(a)})),void t.push(s);case _.eV.TYPE_ADDRESS:case _.eV.TYPE_BOOL:case _.eV.TYPE_U128:case _.eV.TYPE_U256:case _.eV.TYPE_U64:case _.eV.TYPE_U8:case _.eV.TYPE_VEC_ADDRESS:case _.eV.TYPE_VEC_BOOL:case _.eV.TYPE_VEC_U128:case _.eV.TYPE_VEC_U256:case _.eV.TYPE_VEC_U64:case _.eV.TYPE_VEC_U8:case _.eV.TYPE_VEC_VEC_U8:case _.eV.TYPE_OPTION_ADDRESS:case _.eV.TYPE_OPTION_BOOL:case _.eV.TYPE_OPTION_U128:case _.eV.TYPE_OPTION_U256:case _.eV.TYPE_OPTION_U64:case _.eV.TYPE_OPTION_U8:case _.eV.TYPE_STRING:return s.ret_type=s.type,void t.push(s);case _.EL.TYPE_CLOCK:return s.ret_type=_.eV.TYPE_U64,void t.push(s);case _.EL.TYPE_SIGNER:case _.EL.TYPE_GUARD:return s.ret_type=_.eV.TYPE_ADDRESS,void t.push(s);case _.EL.TYPE_CONSTANT:let c=e.find((e=>e.identifier==s?.identifier));return c||(0,h.f)(h.I.Fail,"OperateParamCount: identifier  invalid "+s.type),s.ret_type=c?.type,void t.push(s)}(0,h.f)(h.I.Fail,"OperateParamCount: type  invalid "+s.type)};static Parse_Guard_Helper(e,t){const s=_.Zs.Instance(),a=new p(e);return t.forEach((e=>{const t=e.data?.content;if(t||(0,h.f)(h.I.Fail,"Parse_Guard_Helper invalid content"),-1===s.WOWOK_OBJECTS_TYPE().findIndex((e=>e.includes("guard::Guard")&&e==t.type))&&(0,h.f)(h.I.Fail,"Parse_Guard_Helper invalid type: "+t.type),t.fields.input.type===s.package("base")+"::bcs::BCS"){const s=p.parse_constant(t.fields.constants),r=p.parse_bcs(s,Uint8Array.from(t.fields.input.fields.bytes));a.guard_list.push({id:t.fields.id.id,input:[...r],constant:[...s],digest:e.data?.digest??"",version:e.data?.version??""})}else(0,h.f)(h.I.Fail,"Parse_Guard_Helper invalid package: "+t.fields.input.type)})),a}static Create=async(e,t)=>{if(!(0,i.ij)(e,i.jE))return void(t&&t(void 0));let s=(0,i.SI)(e);if(!t){const t=await _.Zs.Instance().query_raw(s);return p.Parse_Guard_Helper(e,t)}_.Zs.Instance().query_raw(s).then((s=>{t(p.Parse_Guard_Helper(e,s))})).catch((e=>{console.log(e),t(void 0)}))};future_fills=()=>{const e=[];return this.guard_list.forEach((t=>{t.constant.filter((e=>e.bWitness)).forEach((s=>{const a=t.input.filter((e=>e.identifier===s.identifier&&void 0!==e.cmd)).map((e=>e.cmd));let r=0;t.input.forEach((e=>{e.identifier===s.identifier&&r++})),e.push({guard:t.id,witness:void 0,identifier:s.identifier,type:s.type,cmd:a??[],cited:r})}))})),e};static parse_constant=e=>{let t=[];return e.forEach((e=>{let s=e?.fields??e;const a=Uint8Array.from(s.value),r=a.slice(0,1)[0];if(s.bWitness)t.push({identifier:s.identifier,type:r,bWitness:s.bWitness,value:void 0});else{var n=a.slice(1);switch(r){case _.eV.TYPE_ADDRESS:n="0x"+i.ji.getInstance().de(_.eV.TYPE_ADDRESS,Uint8Array.from(n)).toString();break;case _.eV.TYPE_BOOL:case _.eV.TYPE_U8:case _.eV.TYPE_U64:case _.eV.TYPE_U128:case _.eV.TYPE_U256:case _.eV.TYPE_VEC_U8:case _.eV.TYPE_VEC_U64:case _.eV.TYPE_VEC_U128:case _.eV.TYPE_VEC_ADDRESS:case _.eV.TYPE_VEC_BOOL:case _.eV.TYPE_VEC_VEC_U8:case _.eV.TYPE_OPTION_ADDRESS:case _.eV.TYPE_OPTION_BOOL:case _.eV.TYPE_OPTION_U128:case _.eV.TYPE_OPTION_U8:case _.eV.TYPE_OPTION_U64:case _.eV.TYPE_OPTION_U256:case _.eV.TYPE_VEC_U256:case _.eV.TYPE_STRING:case _.eV.TYPE_OPTION_STRING:case _.eV.TYPE_OPTION_VEC_U8:case _.eV.TYPE_VEC_STRING:_.Bd.find((e=>e.type==r))||(0,h.f)(h.I.Fail,"GuardObject de error"),n=i.ji.getInstance().de(r,Uint8Array.from(n));break;default:(0,h.f)(h.I.Fail,"GuardObject constant type invalid:"+r)}t.push({identifier:s.identifier,type:r,bWitness:s.bWitness,value:n})}})),t};static parse_bcs=(e,t)=>{let s=Uint8Array.from(t),a=[].slice.call(s.reverse()),r=[];for(;a.length>0;){let t,s,n,o=a.shift();switch(o){case _.EL.TYPE_SIGNER:case _.EL.TYPE_CLOCK:case _.EL.TYPE_GUARD:case _.hu.TYPE_LOGIC_NOT:case _.hu.TYPE_NUMBER_ADDRESS:break;case _.hu.TYPE_LOGIC_AS_U256_GREATER:case _.hu.TYPE_LOGIC_AS_U256_GREATER_EQUAL:case _.hu.TYPE_LOGIC_AS_U256_LESSER:case _.hu.TYPE_LOGIC_AS_U256_LESSER_EQUAL:case _.hu.TYPE_LOGIC_AS_U256_EQUAL:case _.hu.TYPE_LOGIC_EQUAL:case _.hu.TYPE_LOGIC_HAS_SUBSTRING:case _.hu.TYPE_NUMBER_ADD:case _.hu.TYPE_NUMBER_DEVIDE:case _.hu.TYPE_NUMBER_MOD:case _.hu.TYPE_NUMBER_MULTIPLY:case _.hu.TYPE_NUMBER_SUBTRACT:case _.hu.TYPE_LOGIC_AND:case _.hu.TYPE_LOGIC_OR:t=a.shift();break;case _.EL.TYPE_CONSTANT:n=a.shift();break;case _.eV.TYPE_ADDRESS:t="0x"+i.ji.getInstance().de(_.eV.TYPE_ADDRESS,Uint8Array.from(a)).toString(),a.splice(0,32);break;case _.eV.TYPE_BOOL:case _.eV.TYPE_U8:t=i.ji.getInstance().de(o,Uint8Array.from(a)),a.shift();break;case _.eV.TYPE_U64:t=i.ji.getInstance().de(o,Uint8Array.from(a)),a.splice(0,8);break;case _.eV.TYPE_U128:t=i.ji.getInstance().de(o,Uint8Array.from(a)),a.splice(0,16);break;case _.eV.TYPE_U256:t=i.ji.getInstance().de(o,Uint8Array.from(a)),a.splice(0,32);break;case _.eV.TYPE_VEC_U8:case _.eV.TYPE_VEC_BOOL:case _.eV.TYPE_STRING:let r=(0,i.jz)(Uint8Array.from(a));t=i.ji.getInstance().de(o,Uint8Array.from(a)),a.splice(0,r.value+r.length);break;case _.eV.TYPE_VEC_ADDRESS:r=(0,i.jz)(Uint8Array.from(a)),t=i.ji.getInstance().de(o,Uint8Array.from(a)),a.splice(0,32*r.value+r.length);break;case _.eV.TYPE_VEC_U128:r=(0,i.jz)(Uint8Array.from(a)),t=i.ji.getInstance().de(o,Uint8Array.from(a)),a.splice(0,16*r.value+r.length);break;case _.eV.TYPE_VEC_U256:r=(0,i.jz)(Uint8Array.from(a)),t=i.ji.getInstance().de(o,Uint8Array.from(a)),a.splice(0,32*r.value+r.length);break;case _.eV.TYPE_VEC_U64:r=(0,i.jz)(Uint8Array.from(a)),t=i.ji.getInstance().de(o,Uint8Array.from(a)),a.splice(0,8*r.value+r.length);break;case _.eV.TYPE_VEC_VEC_U8:case _.eV.TYPE_VEC_STRING:r=(0,i.jz)(Uint8Array.from(a)),a.splice(0,r.length);let c=[];for(let e=0;e<r.value;e++){let e=(0,i.jz)(Uint8Array.from(a));c.push(i.ji.getInstance().de(_.eV.TYPE_VEC_U8,Uint8Array.from(a))),a.splice(0,e.length+e.value)}t=c;break;case _.hu.TYPE_QUERY:let l=a.splice(0,1);if(l[0]==_.eV.TYPE_ADDRESS){let e="0x"+i.ji.getInstance().de(_.eV.TYPE_ADDRESS,Uint8Array.from(a)).toString();a.splice(0,32),t=e,s=i.ji.getInstance().de("u16",Uint8Array.from(a.splice(0,2)))}else if(l[0]==_.EL.TYPE_CONSTANT){let t=a.splice(0,1);e.find((e=>e.identifier==t[0]&&e.type==_.eV.TYPE_ADDRESS))||(0,h.f)(h.I.Fail,"GuardObject: indentifier not in  constant"),n=t[0],s=i.ji.getInstance().de("u16",Uint8Array.from(a.splice(0,2)))}else(0,h.f)(h.I.Fail,"GuardObject: constant type invalid");break;case _.eV.TYPE_OPTION_ADDRESS:let p=(0,i.gz)(a,_.eV.TYPE_ADDRESS);t=p.value,p.bNone||a.splice(0,32);break;case _.eV.TYPE_OPTION_BOOL:p=(0,i.gz)(a,_.eV.TYPE_BOOL),t=p.value,p.bNone||a.splice(0,1);break;case _.eV.TYPE_OPTION_U8:p=(0,i.gz)(a,_.eV.TYPE_U8),t=p.value,p.bNone||a.splice(0,1);break;case _.eV.TYPE_OPTION_U128:p=(0,i.gz)(a,_.eV.TYPE_U128),t=p.value,p.bNone||a.splice(0,16);break;case _.eV.TYPE_OPTION_U256:p=(0,i.gz)(a,_.eV.TYPE_U256),t=p.value,p.bNone||a.splice(0,32);break;case _.eV.TYPE_OPTION_U64:p=(0,i.gz)(a,_.eV.TYPE_U64),t=p.value,p.bNone||a.splice(0,8);break;case _.eV.TYPE_OPTION_STRING:p=(0,i.Hn)(a),t=p.value;break;default:(0,h.f)(h.I.Fail,"GuardObject: parse_bcs types "+o)}r.push({type:o,value:t,cmd:s,identifier:n})}return r};done=async(e,t)=>{let s=[];if(this.guard_list.forEach((t=>{t.constant.forEach((t=>{if(t.bWitness){const s=e?.find((e=>e.identifier===t.identifier));s?t.value=s.witness:(0,h.f)(h.I.Fail,"done: invalid witness "+t.identifier)}})),t.input.filter((e=>void 0!==e.cmd)).forEach((e=>{if(void 0!==e.identifier){const a=t.constant.find((t=>t.identifier===e.identifier&&t.type===_.eV.TYPE_ADDRESS));a&&(0,i.jE)(a.value)||(0,h.f)(h.I.Fail,"done: invalid identifier "+e.identifier),s.push(a.value)}else s.push(e.value)}))})),t)return 0===s.length?void t(this.done_helper([])):void _.Zs.Instance().query_raw((0,i.SI)(s),{showType:!0}).then((e=>{t(this.done_helper(e))})).catch((e=>{console.log(e),t(void 0)}));{let e=[];return s.length>0&&(e=await _.Zs.Instance().query_raw((0,i.SI)(s),{showType:!0})),this.done_helper(e)}};done_helper(e){let t=[],s=[];return this.guard_list.forEach((a=>{s.push(a.id),a.input.filter((e=>void 0!==e.cmd)).forEach((s=>{let r=s.value;r||void 0===s.identifier||(r=a.constant.find((e=>e.identifier==s.identifier))?.value);let i=e.find((e=>e.data?.objectId==r));i||(0,h.f)(h.I.Fail,"query object not match");let n=this.object_query(i.data);n||(0,h.f)(h.I.Fail,"query object fail"),t.push(n)}))})),{query:t,info:this.guard_list}}object_query=(e,t="guard_query")=>{for(let s=0;s<_.Zs.Instance().WOWOK_OBJECTS_TYPE().length;s++)if(e.type.includes(_.Zs.Instance().WOWOK_OBJECTS_TYPE()[s]))return{target:_.Zs.Instance().WOWOK_OBJECTS_PREFIX_TYPE()[s]+t,object:l.G.SharedObjectRef({objectId:e.objectId,mutable:!1,initialSharedVersion:e.version}),types:(0,i.Lw)(e.type),id:e.objectId}}}class d{static MAX_GUARD_COUNT=8;passport;txb;get_object(){return this.passport}constructor(e,t,s=!1){(0===t.info.length||t.info.length>d.MAX_GUARD_COUNT)&&(0,h.f)(h.I.InvalidParam,"guards"),this.txb=e,this.passport=this.txb.moveCall({target:_.Zs.Instance().passportFn("new"),arguments:[]}),t.info.forEach((t=>{const s=t.constant.filter((e=>e.bWitness)).map((e=>e.identifier)),a=t.constant.filter((e=>e.bWitness)).map((e=>{const t=i.ji.getInstance().ser(e.type,e.value);let s=new Uint8Array(t.length+1);return s.set([e.type],0),s.set(t,1),[].slice.call(s)})),r=void 0!==t.version&&void 0!==t.digest?e.objectRef({objectId:t.id,version:t.version,digest:t.digest}):e.object(t.id);this.txb.moveCall({target:_.Zs.Instance().passportFn("guard_add"),arguments:[this.passport,r,this.txb.pure.vector("u8",[].slice.call(s)),this.txb.pure(i.ji.getInstance().ser("vector<vector<u8>>",[...a]))]})}));const a=this.txb.sharedObjectRef(_.Zs.CLOCK_OBJECT);t?.query.forEach((e=>{this.txb.moveCall({target:_.Zs.Instance().passportFn("passport_verify"),arguments:[this.passport,this.txb.object(a)]}),this.txb.moveCall({target:e.target,arguments:[s?this.txb.object(e.object):this.txb.object(e.id),this.passport],typeArguments:e.types})})),this.txb.moveCall({target:_.Zs.Instance().passportFn("passport_verify"),arguments:[this.passport,this.txb.object(a)]})}destroy(){this.txb.moveCall({target:_.Zs.Instance().passportFn("destroy"),arguments:[this.passport]})}freeze(){this.txb.moveCall({target:_.Zs.Instance().passportFn("freezen"),arguments:[this.passport]})}query_result(e,t){this.txb.moveCall({target:_.Zs.Instance().passportFn("query_result"),arguments:[this.passport]}),_.Zs.Client().devInspectTransactionBlock({sender:e,transactionBlock:this.txb}).then((e=>{const s=d.ResolveQueryRes(this.txb,e);s&&t(s)})).catch((e=>{console.log(e)}))}query_result_async=async e=>{this.txb.moveCall({target:_.Zs.Instance().passportFn("query_result"),arguments:[this.passport]});const t=await _.Zs.Client().devInspectTransactionBlock({sender:e,transactionBlock:this.txb});return d.ResolveQueryRes(this.txb,t)};static ResolveQueryRes(e,t){for(let s=0;s<t.results?.length;++s){const a=t.results[s];if(a?.returnValues&&2===a.returnValues.length&&"bool"===a.returnValues[0][1]&&"vector<address>"===a.returnValues[1][1])return{txb:e,result:i.ji.getInstance().de("bool",Uint8Array.from(a.returnValues[0][0])),guards:i.ji.getInstance().de("vector<address>",Uint8Array.from(a.returnValues[1][0])).map((e=>"0x"+e))}}}}var u=s(4285),E=s(3499),T=s(6601),m=s(3857),b=s(3810),I=s(2871);const f=200;function g(e,t,s){t||(0,h.f)(h.I.InvalidParam,"Payment.New.pay_token_type"),s.receiver.length>f&&(0,h.f)(h.I.InvalidParam,"Payment.New.param.receiver"),(0,i.ij)(s.receiver,(e=>(0,i.jE)(e.address)&&_.Zs.IsValidObjects([e.coin])))||(0,h.f)(h.I.IsValidArray,"Payment.New.param.receiver"),s?.for_object&&!(0,i.jE)(s.for_object)&&(0,h.f)(h.I.IsValidAddress,"Payment.New.param.for_object"),s?.for_guard&&!(0,i.jE)(s.for_guard)&&(0,h.f)(h.I.IsValidAddress,"Payment.New.param.for_guard"),s?.business_remark&&!(0,i.yW)(s?.business_remark)&&(0,h.f)(h.I.IsValidDesription,"Payment.New.param.business_remark");let a=e.pure.option("address",s.for_object?s.for_object:void 0);const r=e.sharedObjectRef(_.Zs.CLOCK_OBJECT);return s.for_guard?e.moveCall({target:_.Zs.Instance().paymentFn("create_withGuard"),arguments:[e.pure.vector("address",s.receiver.map((e=>e.address))),e.makeMoveVec({elements:s.receiver.map((e=>e.coin))}),a,e.object(s.for_guard),e.pure.u64(s.business_index),e.pure.string(s.business_remark),e.object(r)],typeArguments:[t]}):e.moveCall({target:_.Zs.Instance().paymentFn("create"),arguments:[e.pure.vector("address",s.receiver.map((e=>e.address))),e.makeMoveVec({elements:s.receiver.map((e=>e.coin))}),a,e.pure.u64(s.business_index),e.pure.string(s.business_remark),e.object(r)],typeArguments:[t]})}var O=s(4313),v=s(9876),y=s(8278),C=s(9635),P=s(8091),x=s(9627),B=s(1789),V=s(8338),U=s(9298)}}]);